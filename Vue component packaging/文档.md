## vue组件封装

### 1.消息提示

- 固定顶部显示，有三种类型：成功，错误，警告。
- 显示消息提示时需要动画从上滑入且淡出。
- 组件使用的方式不够便利，封装成工具函数方式。

1.定义组件：`src/components/lm-message.vue`

```vue
<template>
    <div class="lm-message" :style="style[type]">
      <i class="iconfont" :class="[style[type].icon]"></i>
      <span class="text">{{ text }}</span>
    </div>
</template>
<script>
import { onMounted, ref } from "vue";
export default {
  name: "LmMessage",
  props: {
    text: {
      type: String,
      default: "",
    },
    type: {
      type: String,
      // warn 警告  error 错误  success 成功
      default: "warn",
    },
  },
  setup() {
    // 定义一个对象，包含三种情况的样式，对象key就是类型字符串
    const style = {
      warn: {
        icon: "icon-jinggao",
        color: "#E6A23C",
        backgroundColor: "rgb(253, 246, 236)",
        borderColor: "rgb(250, 236, 216)",
      },
      error: {
        icon: "icon-cuowu",
        color: "#F56C6C",
        backgroundColor: "rgb(254, 240, 240)",
        borderColor: "rgb(253, 226, 226)",
      },
      success: {
        icon: "icon-chenggong",
        color: "#67C23A",
        backgroundColor: "rgb(240, 249, 235)",
        borderColor: "rgb(225, 243, 216)",
      },
    };
    // 定义一个数据控制显示隐藏，默认是隐藏，组件挂载完毕显示
    const visible = ref(false);
    onMounted(() => {
      visible.value = true;
    });
    return {
      style,
      visible,
    };
  },
};
</script>
<style scoped lang="scss">
.lm-message {
  width: 300px;
  height: 50px;
  position: fixed;
  z-index: 9999;
  left: 50%;
  margin-left: -150px;
  top: 25px;
  line-height: 50px;
  padding: 0 25px;
  border: 1px solid #e4e4e4;
  background: #f5f5f5;
  color: #999;
  border-radius: 4px;
  i {
    margin-right: 4px;
    vertical-align: middle;
  }
  .text {
    vertical-align: middle;
  }
}
</style>
```

- 使用组件

```vue
<XtxMessage text="手机号或密码错误" type="error" />
```

2.封装函数——方便调用组件 `src/components/Message.js`

```js
// 实现使用函数调用lm-message组件的逻辑
import { createVNode, render } from 'vue'
import LmMessage from './lm-message.vue'

// 准备dom容器
const div = document.createElement('div')
div.setAttribute('class', 'lm-message-container')
document.body.appendChild(div)
// 定时器标识
let timer = null

export default ({ type, text }) => {
  // 实现：根据lm-message.vue渲染消息提示
  // 1. 导入组件
  // 2. 根据组件创建虚拟节点
  const vnode = createVNode(LmMessage, { type, text })
  // 3. 准备一个DOM容器
  // 4. 把虚拟节点渲染DOM容器中
  render(vnode, div)
  // 5. 开启定时，移出DOM容器内容
  clearTimeout(timer)
  timer = setTimeout(() => {
    render(null, div)
  }, 3000)
}
```

​	使用 `/views/HomeViews`

```vue
<template>
  <div class="home">
    <h2>1.消息提示</h2>
    <div class="messageBtn">
      <button @click="getWarn">警告</button>
      <button @click="getError">错误</button>
      <button @click="getSuccess">成功</button>
      </div>
  </div>
</template>

<script>
import Message from '@/components/Message'
export default {
  name: 'HomeView',
  setup(){
    const getWarn=()=>{
      Message({ type: 'warn', text: '提示信息！',times:1 });
    }
    const getError=()=>{
      Message({ type: 'error', text: '错误信息！',times:3 });
    }
    const getSuccess=()=>{
      Message({ type: 'success', text: '成功信息！',times:5 });
    }
    return {
      getWarn,
      getError,
      getSuccess
    }
  }
}
</script>
<style lang="scss" scoped>
.home{
  width: 100%;
  padding: 10px;
  .messageBtn{
    width: 300px;
    display: flex;
    justify-content: space-between;
  }
}
</style>
```

